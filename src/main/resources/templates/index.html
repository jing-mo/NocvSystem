<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <title>Layui</title>
    <!-- 引入刚刚下载的 ECharts 文件 -->
    <script th:src="@{../static/echarts/echarts.min.js}"></script>
    <script th:src="@{../static/echarts/jquery-3.6.1.min.js}"></script>
    <script th:src="@{../static/echarts/china.js}"></script>
    <script th:src="@{../static/layui/layui.js}" charset="utf-8"></script>
    <link rel="stylesheet" th:href="@{../static/layui/css/layui.css}"   media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
    </head>
    <body>
    <!--layui引入公共模块-->
    <div th:include="commommenu :: menu">
    </div>
    <div class="layui-body">
      <!-- 内容主体区域 -->
      <div style="padding: 15px;">
        <div id="main" style="width:900px;height:700px;"></div>
      </div>
    </div>
    <!-- 为 ECharts 准备一个定义了宽高的 DOM -->
    <script>
      //JS
      layui.use(['element', 'layer', 'util'], function(){
        var element = layui.element
                ,layer = layui.layer
                ,util = layui.util
                ,$ = layui.$;

        //头部事件
        util.event('lay-header-event', {
          //左侧菜单事件
          menuLeft: function(othis){
            layer.msg('展开左侧菜单的操作', {icon: 0});
          }
          ,menuRight: function(){
            layer.open({
              type: 1
              ,content: '<div style="padding: 15px;">处理右侧面板的操作</div>'
              ,area: ['260px', '100%']
              ,offset: 'rt' //右上角
              ,anim: 5
              ,shadeClose: true
            });
          }
        });

      });
    </script>
    <script type="text/javascript">
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('main'));
            var dataList = [];
            option = {
                tooltip: {
                    triggerOn: "click",
                    formatter: function(e, t, n) {
                        return '.5' == e.value ? e.name + "：有疑似病例" : e.seriesName + "<br />" + e.name + "：" + e.value
                    }
                },
                toolbox: {
                        show: true,
                        orient: 'vertical',
                        left: 'right',
                        top: 'center',
                        feature: {
                            dataView: {readOnly: false},
                            restore: {},
                            saveAsImage: {}
                        }
                    }, // 提供下载工具
                visualMap: {
                    min: 0,
                    max: 100000,
                    left: 26,
                    bottom: 40,
                    showLabel: !0,
                    text: ["高", "低"],
                    pieces: [{
                        gt: 10000,
                        label: "> 10000人",
                        color: "#339966"
                    }, {
                        gte: 1000,
                        lte: 10000,
                        label: "1000 - 10000人",
                        color: "#339999"
                    }, {
                        gte: 100,
                        lt: 1000,
                        label: "100 - 1000人",
                        color: "#3399CC"
                    }, {
                        gt: 10,
                        lt: 100,
                        label: "10 - 100人",
                        color: "#3399FF"
                    }, {
                        gt: 1,
                        lt: 10,
                        label: "1 - 10人",
                        color: "#ffffff"
                    }],
                    show: !0
                },
                geo: {
                    map: "china",
                    roam: !1,
                    scaleLimit: {
                        min: 1,
                        max: 2
                    },
                    zoom: 1.23,
                    top: 120,
                    label: {
                        normal: {
                            show: !0,
                            fontSize: "14",
                            color: "rgba(0,0,0,0.7)"
                        }
                    },
                    itemStyle: {
                        normal: {
                            //shadowBlur: 50,
                            //shadowColor: 'rgba(0, 0, 0, 0.2)',
                            borderColor: "rgba(0, 0, 0, 0.2)"
                        },
                        emphasis: {
                            areaColor: "#33FFFF",
                            shadowOffsetX: 0,
                            shadowOffsetY: 0,
                            borderWidth: 0
                        }
                    }
                }
            };
                        $.ajax({
                          url:"/query",
                          dataType:"json",
                          success:function(data) {
                            for (let i in data) {
                              dataList[i] = data[i];
                            }
                            myChart.setOption({
                              series: [
                                {
                                  name: "确诊病例",
                                  type: "map",
                                  geoIndex: 0,
                                  data: dataList
                                }
                              ]
                            })
                          }
                        });
      // 使用刚指定的配置项和数据显示图表。
      myChart.setOption(option);
    </script>
  </body>
</html>